{"version":3,"sources":["webpack:///webpack/bootstrap 91f74a8b1b2639f8563f","webpack:///./src/server/server.js","webpack:///external \"express\"","webpack:///external \"http\"","webpack:///external \"socket.io\"","webpack:///./src/server/memory-game.js","webpack:///./src/shared/game.js","webpack:///external \"es6-event-emitter\"","webpack:///./src/shared/player.js","webpack:///./src/cards.json","webpack:///external \"guid\"","webpack:///external \"fs\""],"names":["express","require","app","router","Router","server","Server","io","use","static","get","req","res","sendfile","listen","Guid","fs","Cards","JSON","parse","readFileSync","pairs","getRandomCards","sort","a","b","Math","random","cardsToUse","i","card","floor","push","name","src","memoryGame","game","setCards","on","emit","player","guid","next","console","log","setInterval","players","length","started","getState","nextTurn","pairsLeft","cards","forEach","found","socket","flipCard","index","timeout","setTimeout","removePlayer","existingPlayer","getPlayer","clearTimeout","connected","disconnect","raw","addPlayer","getInfo","module","exports","Game","currentTurn","firstCard","secondCard","flipped","trigger","newCard","find","Object","assign","updateCard","indexOf","nextPlayer","playerIndex","findIndex","splice","map","state","Player","color","totalPoints"],"mappings":"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","file":"server.build.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"./server/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 91f74a8b1b2639f8563f","'use strict';\r\n\r\nconst express = require('express');\r\nconst app = express();\r\nconst router = express.Router();\r\n\nconst server = require('http').Server(app);\r\nconst io = require('socket.io')(server);\n\r\napp.use(express.static('./dist'));\r\n\r\napp.use(require('./memory-game')(io));\r\n\r\napp.get('/', function(req, res) {\r\n    res.sendfile('./dist/index.html');\r\n});\r\n\r\nserver.listen(8080);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/server.js","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 2\n// module chunks = 0","module.exports = require(\"http\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"http\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"socket.io\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"socket.io\"\n// module id = 4\n// module chunks = 0","const express = require('express');\r\nconst Guid = require('guid');\r\nconst fs = require('fs');\r\n\r\nimport Game from '../shared/game';\r\nimport asdasd from '../cards.json';\r\nconst Cards = typeof asdasd === \"string\" ? JSON.parse(fs.readFileSync(asdasd, 'utf8')) : asdasd;\r\n\r\nconst pairs = 8;\r\n\r\nconst getRandomCards = () => {\r\n  Cards.sort((a,b) => {\r\n    return 0.5 - Math.random();\r\n  });\r\n\r\n  let cardsToUse = [];\r\n\r\n//select cards\r\n  for(let i = 0; i < pairs*2; ++i){\r\n    const card = Cards[Math.floor(i/2)];\r\n    cardsToUse.push({\r\n      name: card.name,\r\n      src: card.src\r\n    })\r\n  }\r\n\r\n//randomize selected cards\r\n  cardsToUse.sort((a,b) => {\r\n    return 0.5 - Math.random();\r\n  });\r\n\r\n  return cardsToUse;\r\n}\r\n\r\n\r\nconst memoryGame = (io) => {\r\n  const router = express.Router();\r\n  const game = new Game();\r\n  game.setCards(getRandomCards());\r\n\r\n  game.on('addPlayer', player => {\r\n    io.emit('addPlayer', player);\r\n  });\r\n\r\n  game.on('removePlayer', guid => {\r\n    io.emit('removePlayer', guid);\r\n  });\r\n\r\n  game.on('updatePlayer', player => {\r\n    io.emit('updatePlayer', player);\r\n  });\r\n\r\n  game.on('nextTurn', guid => {\r\n    io.emit('nextTurn', guid);\r\n  });\r\n\r\n  router.get('/api',  (req, res, next) => {\r\n    console.log('Got APi');\r\n  });\r\n\r\n  let i = 0;\r\n  setInterval(()=> {\r\n    io.emit('status', 'Loop ' + i++);\r\n    if(game.players.length < 2){\r\n      io.emit('status', 'Not enough players!');\r\n      return;\r\n    }\r\n\r\n    if(!game.started){\r\n      game.started = true;\r\n      io.emit('status', 'Starting new game...');\r\n      game.setCards(getRandomCards());\r\n      io.emit('gameState', game.getState());\r\n      game.nextTurn(game.players[0].guid);\r\n    }\r\n\r\n    let pairsLeft = game.cards.length;\r\n    game.cards.forEach(card => {\r\n      if(card.found){\r\n        pairsLeft--;\r\n      }\r\n    })\r\n    pairsLeft /= 2;\r\n\r\n    io.emit('status', 'Pairs left... ' + pairsLeft);\r\n\r\n\r\n  }, 1000);\r\n\r\n  io.on('connection', function(socket){\r\n    console.log('a user connected');\r\n    socket.emit('status', 'Connected...');\r\n\r\n    socket.on('flipCard', index => {\r\n      if(!socket.player){\r\n        return;\r\n      }\r\n\r\n      const player = socket.player;\r\n\r\n      game.flipCard(player, index);\r\n    });\r\n\r\n    socket.on('disconnect', () => {\r\n      if(socket.player){\r\n        const guid = socket.player.guid;\r\n        socket.player.timeout = setTimeout(() => {\r\n          //delete a player after being disconnected for 10 seconds\r\n          console.log('10 seconds have passed so we will remove player!');\r\n          game.removePlayer(guid);\r\n        }, 1000*10);\r\n      }\r\n    })\r\n\r\n    socket.on('auth', (player) => {\r\n      if(!player){\r\n        return socket.emit('game_error', 'You need to send some player data!');\r\n      }\r\n\r\n      const name = player.name;\r\n      const guid = player.guid;\r\n\r\n      if(player.guid){\r\n        let existingPlayer = game.getPlayer(player.guid);\r\n        if(existingPlayer){\r\n            if(existingPlayer.timeout){\r\n              clearTimeout(existingPlayer.timeout);\r\n            }\r\n            if(existingPlayer.socket.connected){\r\n              existingPlayer.socket.disconnect();\r\n            }\r\n            player = existingPlayer;\r\n        }else{\r\n          //socket.emit('game_error', 'Couldnt find player with GUID: ' + guid);\r\n          player.guid = Guid.raw();\r\n          player = game.addPlayer(player); //Add new player\r\n        }\r\n      }else{\r\n        player.guid = Guid.raw();\r\n        player = game.addPlayer(player);\r\n      }\r\n\r\n      socket.player = player;\r\n      player.socket = socket;\r\n\r\n\r\n      socket.emit('authSuccess', player.getInfo());\r\n      socket.emit('gameState', game.getState());\r\n\r\n      console.log('Auth', name, guid);\r\n    });\r\n\r\n  });\r\n  return router;\r\n}\r\n\r\nmodule.exports = memoryGame;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/memory-game.js","import EventEmitter from 'es6-event-emitter';\r\nimport Player from './player';\r\n\r\nclass Game extends EventEmitter{\r\n  constructor(){\r\n    super();\r\n    this.players = [];\r\n    this.cards = [];\r\n\r\n    this.currentTurn = null;\r\n    this.firstCard = null;\r\n    this.secondCard = null;\r\n  }\r\n\r\n  setCards(cards) {\r\n    this.cards = [];\r\n    cards.forEach((card, i) => {\r\n      this.cards.push({\r\n        index: i,\r\n        name: card.name,\r\n        src: card.src,\r\n        flipped: card.flipped || false,\r\n        found: card.found\r\n      });\r\n    });\r\n    this.trigger('setCards');\r\n  }\r\n\r\n  updateCard(newCard){\r\n    let card = this.cards.find(card => {\r\n      return newCard.index === card.index;\r\n    });\r\n\r\n    Object.assign(card, newCard);\r\n    this.trigger('updateCard', newCard);\r\n  }\r\n\r\n  updateCards(cards) {\r\n    cards.forEach(card => {\r\n      this.updateCard(card);\r\n    });\r\n  }\r\n\r\n  flipCard(player, index){\r\n    if(this.currentTurn != player.guid){\r\n      this.trigger('error', 'player tried to flip card without it being their turn!');\r\n      return;\r\n    }\r\n\r\n    const card = this.cards[index];\r\n\r\n    if(!card){\r\n      this.trigger('error', 'Card doesnt exist!');\r\n      return;\r\n    }\r\n\r\n    if(this.firstCard && this.secondCard){\r\n      this.trigger('error', 'This player already picked 2 cards!');\r\n      return;\r\n    }\r\n\r\n    if(!this.firstCard){\r\n      this.firstCard = card;\r\n    }else if(this.firstCard){\r\n      this.secondCard = card;\r\n    }\r\n\r\n    if(this.firstCard && this.secondCard){\r\n      if(this.firstCard.name === this.secondCard.name){\r\n        //player scored\r\n        this.firstCard.found = true;\r\n        this.secondCard.found = true;\r\n\r\n        this.trigger('foundPair', player, [this.firstCard, this.secondCard]);\r\n      }\r\n\r\n\r\n      const index = this.players.indexOf(player) + 1;\r\n      const nextPlayer = this.players[index % this.players.length];\r\n      this.nextTurn(nextPlayer.guid);\r\n    }\r\n\r\n    this.trigger('flipCard', card);\r\n  }\r\n\r\n  addPlayer(player) {\r\n    player = new Player(player);\r\n    this.players.push(player);\r\n    this.trigger('addPlayer', player);\r\n    return player;\r\n  }\r\n\r\n  removePlayer(guid) {\r\n    const playerIndex = this.players.findIndex(player => {return player.guid === guid});\r\n    console.log('Removed Player', playerIndex, guid);\r\n    const player = this.players[playerIndex];\r\n    this.players.splice(playerIndex, 1);\r\n\r\n    if(player && this.currentTurn === player.guid){\r\n      this.nextTurn(this.players[(playerIndex+1) % this.players.length]);\r\n    }\r\n\r\n    this.trigger('removePlayer', guid);\r\n  }\r\n\r\n  updatePlayer() {\r\n\r\n  }\r\n\r\n  getPlayer(guid){\r\n    return this.players.find(player => {return player.guid === guid});\r\n  }\r\n\r\n  nextTurn(guid) {\r\n    console.log('Next Turn', guid);\r\n    this.currentTurn = guid;\r\n    this.trigger('nextTurn', guid);\r\n  }\r\n\r\n\r\n  getState() {\r\n    return {\r\n      currentTurn: this.currentTurn,\r\n      players: this.players.map(player => {return player.getInfo(); }),\r\n      cards: this.cards.map((card, i) => {\r\n        return {\r\n          index: i,\r\n          name: card.flipped ? card.name : null,\r\n          flipped: card.flipped,\r\n          found: card.found\r\n        };\r\n      })\r\n    }\r\n  }\r\n\r\n  setState(state) {\r\n    this.currentTurn = state.currentTurn;\r\n\r\n    this.players = state.players.map(player => {\r\n      return new Player(player);\r\n    });\r\n\r\n    this.cards = state.cards.map(card => {\r\n      return card;\r\n    });\r\n\r\n    this.trigger('setState', state);\r\n  }\r\n\r\n}\r\n\r\nexport default Game;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/shared/game.js","module.exports = require(\"es6-event-emitter\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"es6-event-emitter\"\n// module id = 7\n// module chunks = 0","\r\nclass Player{\r\n  constructor(player){\r\n    this.guid = player.guid;\r\n    this.name = player.name;\r\n    this.color = player.color;\r\n    this.pairs = 0;\r\n    this.totalPoints = 0;\r\n  }\r\n\r\n  getInfo(){\r\n    return {\r\n      guid: this.guid,\r\n      name: this.name,\r\n      color: this.color,\r\n      pairs: this.pairs,\r\n      totalPoints: this.totalPoints\r\n    }\r\n  }\r\n\r\n}\r\n\r\nexport default Player;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/shared/player.js","module.exports = __webpack_public_path__ + \"54d8b1839b94c790c33698346d57bff9.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/cards.json\n// module id = 9\n// module chunks = 0","module.exports = require(\"guid\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"guid\"\n// module id = 10\n// module chunks = 0","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 11\n// module chunks = 0"],"sourceRoot":""}